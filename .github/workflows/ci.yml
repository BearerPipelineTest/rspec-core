# This file was generated on 2021-01-22T09:55:42+00:00 from the rspec-dev repo.
# DO NOT modify it by hand as your changes will get lost the next time it is generated.

name: RSpec CI
on:
  push:
    branches:
      - 'main'
      - '*-maintenance'
      - '*-dev'
      - 'experimental-github-actions'
  pull_request:
    branches:
      - '*'
env:
  RSPEC_CI: true
  # This tells rspec-rails what branch to run in ci
  RSPEC_VERSION: '= 3.11.0.pre'
jobs:
  legacy:
    name: Legacy Ruby Builds (${{ matrix.container.version }})
    runs-on: ubuntu-20.04
    container:
      image: ${{ matrix.container.tag }}
      options: ${{ matrix.container.options || '--add-host github-complains-if-this-is-empty.com:127.0.0.1' }}
    strategy:
      fail-fast: false
      matrix:
        container:
          - version: "Ruby 1.8.7"
            tag: rspec/ci:1.8.7
            options: "--add-host rubygems.org:151.101.0.70 --add-host api.rubygems.org:151.101.0.70"
          - version: "Ruby 2.0.0"
            tag: rspec/ci:2.0.0
    env:
      LEGACY_CI: true
      JRUBY_OPTS: ${{ matrix.container.jruby_opts || '--dev' }}
    steps:
      - uses: actions/checkout@v2
      - run: ${{ matrix.container.pre }}
      - run: script/legacy_setup.sh
      - run: bundle exec bin/rspec
      - run: bundle exec script/cucumber.sh
